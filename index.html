<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
</head>

<body>

    <script>
        class GamePlay extends Phaser.Scene {
            camera;
            cursors;

            preload() {
                // this.load.setBaseURL('https://labs.phaser.io');

                // this.load.image('sky', 'assets/skies/space3.png');
                // this.load.image('logo', 'assets/sprites/phaser3-logo.png');
                // this.load.image('red', 'assets/particles/red.png');
                this.load.image('background', 'images/tile.png')
                this.load.image('logo', 'images/bubble.png');
                this.load.image('red', 'images/red.png');
            }

            create() {
                var tileSprite = this.add.tileSprite(0, 0, 10000, 10000, 'background').setOrigin(0, 0);

                // Set up the camera
                this.camera = this.cameras.main;
                this.camera.setBounds(0, 0, 10000, 10000); // Set the camera's boundaries to the size of the world
                
                // Enable cursor keys for camera movement
                this.cursors = this.input.keyboard.createCursorKeys();
                
                const particles = this.add.particles(0, 0, 'red', {
                    speed: 100,
                    scale: { start: 1, end: 0 },
                    blendMode: 'ADD'
                });

                const logo = this.physics.add.image(400, 100, 'logo');

                logo.setVelocity(100, 200);
                logo.setBounce(1, 1);
                logo.setCollideWorldBounds(true);

                particles.startFollow(logo);

                const hudContainer = this.add.container(0, 0).setScrollFactor(0);

                // Add a background rectangle for the HUD
                const hudBg = this.add.rectangle(0, 0, 800, 100, 0x000000, 0.5).setOrigin(0, 0);
                hudContainer.add(hudBg);

                // Add HUD text
                const hudText = this.add.text(10, 10, "Buy/Create Items", {
                    font: '18px Arial',
                    fill: '#ffffff'
                });
                hudContainer.add(hudText);

                // Add a draggable tile image to the HUD
                const tileIcon = this.add.image(200, 50, 'background').setInteractive();
                tileIcon.setScale(0.5); // Scale it down if needed for HUD
                hudContainer.add(tileIcon);

                // Enable drag on the tile
                this.input.setDraggable(tileIcon);

                // Track the tile being dragged
                tileIcon.on('drag', (pointer, dragX, dragY) => {
                    tileIcon.x = dragX;
                    tileIcon.y = dragY;
                });

                // Place tile in the world when released
                tileIcon.on('dragend', (pointer) => {
                    // If released outside the HUD, place the tile
                    if (tileIcon.y > 100) {  // If dragged out of the HUD area
                        // Place a new tile at the drop location
                        const newTile = this.add.image(pointer.worldX, pointer.worldY, 'background').setOrigin(0, 0);
                        newTile.setInteractive();
                        this.input.setDraggable(newTile); // New tiles can also be dragged
                    }

                    // Reset the HUD tile back to its original position
                    tileIcon.x = 200;
                    tileIcon.y = 50;
                });
            }

            update() {
                const scrollSpeed = 10; // Adjust the camera movement speed as needed
                
                var cursors = this.cursors;
                console.log(cursors);
                // Move the camera based on cursor input
                if (cursors.left.isDown) {
                    this.camera.scrollX -= scrollSpeed;
                }
                if (cursors.right.isDown) {
                    this.camera.scrollX += scrollSpeed;
                }
                if (cursors.up.isDown) {
                    this.camera.scrollY -= scrollSpeed;
                }
                if (cursors.down.isDown) {
                    this.camera.scrollY += scrollSpeed;
                }
            }
        }

        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            scene: GamePlay,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 200 }
                }
            }
        };

        const game = new Phaser.Game(config);
    </script>

</body>

</html>